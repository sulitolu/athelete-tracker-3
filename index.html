<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Athlete Data App ‚Äî Day1‚Äì2 MVP</title>
  <style>
    :root{--bg:#0b0f14;--panel:#121821;--ink:#e9eef6;--muted:#9fb0c8;--line:#203045}
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
    header{position:sticky;top:0;background:#0b0f14cc;border-bottom:1px solid #1a2433;backdrop-filter:blur(6px)}
    .wrap{max-width:900px;margin:0 auto;padding:16px}
    h1{font-size:20px;margin:6px 0 8px}
    .sub{color:var(--muted);font-size:12px}
    .tabs{display:flex;gap:6px;flex-wrap:wrap;margin:10px 0}
    .tab{padding:8px 10px;border-radius:10px;background:#111722;border:1px solid #1e2a3b;font-size:13px;color:var(--muted);cursor:pointer}
    .tab.active{color:var(--ink);background:#162034}
    section{display:none}
    .grid{display:grid;gap:12px}
    @media(min-width:860px){.grid.cols-2{grid-template-columns:1fr 1fr}}
    .panel{background:var(--panel);border:1px solid #1d2633;border-radius:14px;padding:12px}
    .panel h2{font-size:15px;margin:0 0 8px}
    label{display:block;color:var(--muted);font-size:12px;margin:8px 0 4px}
    input,button,textarea{width:100%;background:#0b121b;color:var(--ink);border:1px solid var(--line);border-radius:10px;padding:10px;font-size:14px}
    input:focus,textarea:focus{outline:2px solid #1a84ff}
    button{cursor:pointer}
    .row{display:flex;gap:8px;flex-wrap:wrap}
    .row>*{flex:1 1 140px}
    .hint{color:var(--muted);font-size:12px}
    canvas{max-width:100%}
    .table{overflow:auto;border:1px solid #1d2633;border-radius:10px}
    table{width:100%;border-collapse:collapse}
    th,td{padding:8px;border-bottom:1px solid #1b2533;text-align:left;font-size:13px}
    th{color:#9fb0c8;font-weight:600}
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>üèâ Athlete Data App ‚Äî Day1‚Äì2 MVP</h1>
      <div class="sub">Wellness, GPS, Gym logging ‚Ä¢ Weight & GPS charts ‚Ä¢ Data saved to your browser</div>
    </div>
  </header>

  <main class="wrap">
    <nav class="tabs" id="tabs"></nav>

    <!-- HOME (charts) -->
    <section id="home" class="grid cols-2">
      <div class="panel">
        <h2>Weight Trend</h2>
        <canvas id="weightChart" height="170"></canvas>
        <div class="hint">Enter weight in Wellness ‚Üí it appears here.</div>
      </div>
      <div class="panel">
        <h2>GPS Performance</h2>
        <canvas id="gpsChart" height="170"></canvas>
        <div class="hint">Shows Distance (m) and Top Speed (m/s) per day.</div>
      </div>
      <div class="panel" style="grid-column:1/-1">
        <h2>Yesterday at a glance</h2>
        <div id="glance" class="hint">Add today‚Äôs wellness/GPS to populate.</div>
      </div>
    </section>

    <!-- WELLNESS -->
    <section id="wellness" class="grid">
      <div class="panel">
        <h2>Daily Wellness</h2>
        <div class="row">
          <div><label>Date</label><input type="date" id="wDate"></div>
          <div><label>Sleep Hours</label><input type="number" step="0.25" id="wSleep" placeholder="7.0"></div>
          <div><label>Mood (1‚Äì5)</label><input type="number" min="1" max="5" id="wMood" placeholder="3"></div>
          <div><label>Stress (1‚Äì5)</label><input type="number" min="1" max="5" id="wStress" placeholder="2"></div>
          <div><label>Soreness (1‚Äì5)</label><input type="number" min="1" max="5" id="wSore" placeholder="2"></div>
          <div><label>Weight (kg)</label><input type="number" step="0.1" id="wWeight" placeholder="120.0"></div>
          <div style="flex-basis:100%"><label>Notes</label><textarea id="wNotes" rows="2" placeholder=""></textarea></div>
        </div>
        <div class="row">
          <button id="wSave">Add / Update</button>
          <button id="wView">View Table</button>
        </div>
        <div id="wTable" class="table" style="margin-top:10px"></div>
      </div>
    </section>

    <!-- GPS -->
    <section id="gps" class="grid">
      <div class="panel">
        <h2>GPS Session (manual)</h2>
        <div class="row">
          <div><label>Date</label><input type="date" id="gDate"></div>
          <div><label>Duration (min)</label><input type="number" step="1" id="gDur" placeholder="60"></div>
          <div><label>Distance (m)</label><input type="number" step="10" id="gDist" placeholder="4500"></div>
          <div><label>Top Speed (m/s)</label><input type="number" step="0.1" id="gTS" placeholder="8.5"></div>
          <div><label>RPE (1‚Äì10)</label><input type="number" min="1" max="10" id="gRPE" placeholder="6"></div>
        </div>
        <div class="row">
          <button id="gAdd">Add Session</button>
          <button id="gView">View Table</button>
        </div>
        <div id="gTable" class="table" style="margin-top:10px"></div>
      </div>
    </section>

    <!-- GYM -->
    <section id="gym" class="grid">
      <div class="panel">
        <h2>Gym Log</h2>
        <div class="row">
          <div><label>Date</label><input type="date" id="yDate"></div>
          <div><label>Lift</label><input type="text" id="yLift" placeholder="Back Squat"></div>
          <div><label>Reps</label><input type="number" min="1" id="yReps" placeholder="3"></div>
          <div><label>Weight (kg)</label><input type="number" step="0.5" id="yW" placeholder="180"></div>
        </div>
        <div class="row">
          <button id="yAdd">Add Set</button>
          <button id="yView">View Table</button>
        </div>
        <div id="yTable" class="table" style="margin-top:10px"></div>
      </div>
    </section>

    <!-- DATA -->
    <section id="data" class="grid">
      <div class="panel">
        <h2>Data Management</h2>
        <div class="row">
          <button id="btnExport">Export all data (.json)</button>
          <input type="file" id="importFile" accept="application/json">
          <button id="btnClear">Clear local data</button>
        </div>
        <div class="hint" style="margin-top:6px">This MVP stores everything in your browser (LocalStorage). Export regularly if needed.</div>
      </div>
    </section>
  </main>

  <script>
    // ----- Tabs -----
    const TABS = [
      {id:'home',label:'Home'},
      {id:'wellness',label:'Wellness'},
      {id:'gps',label:'GPS'},
      {id:'gym',label:'Gym'},
      {id:'data',label:'Data'}
    ];
    const tabsEl = document.getElementById('tabs');
    TABS.forEach((t,i)=>{
      const b=document.createElement('button');
      b.className='tab'+(i===0?' active':'');
      b.textContent=t.label;
      b.onclick=()=>selectTab(t.id);
      tabsEl.appendChild(b);
    });
    function selectTab(id){
      document.querySelectorAll('section').forEach(s=>s.style.display = (s.id===id?'grid':'none'));
      document.querySelectorAll('.tab').forEach((el,i)=>el.classList.toggle('active', TABS[i].id===id));
      drawAll();
    }

    // ----- State -----
    const S = {
      wellness: JSON.parse(localStorage.getItem('wellness')||'[]'),
      gps: JSON.parse(localStorage.getItem('gps')||'[]'),
      gym: JSON.parse(localStorage.getItem('gym')||'[]')
    };
    const save = ()=>{
      localStorage.setItem('wellness', JSON.stringify(S.wellness));
      localStorage.setItem('gps', JSON.stringify(S.gps));
      localStorage.setItem('gym', JSON.stringify(S.gym));
      drawAll();
    };
    const todayStr = ()=> new Date().toISOString().slice(0,10);
    ['wDate','gDate','yDate'].forEach(id=>{ const el=document.getElementById(id); if(el) el.value=todayStr(); });

    // ----- Wellness -----
    document.getElementById('wSave').onclick = ()=>{
      const r = {
        date: document.getElementById('wDate').value || todayStr(),
        sleep: num('wSleep'), mood: num('wMood'),
        stress: num('wStress'), sore: num('wSore'),
        weight: num('wWeight'), notes: document.getElementById('wNotes').value||''
      };
      const i = S.wellness.findIndex(x=>x.date===r.date);
      if(i>=0) S.wellness[i]=r; else S.wellness.push(r);
      save();
      renderTable('wTable', S.wellness, ['date','sleep','mood','stress','sore','weight']);
    };
    document.getElementById('wView').onclick = ()=>renderTable('wTable', S.wellness, ['date','sleep','mood','stress','sore','weight']);

    // ----- GPS -----
    document.getElementById('gAdd').onclick = ()=>{
      const r = {
        date: document.getElementById('gDate').value || todayStr(),
        dur: num('gDur'), dist: num('gDist'), ts: num('gTS'), rpe: num('gRPE')
      };
      r.srpe = (r.rpe||0)*(r.dur||0);
      S.gps.push(r); save();
      renderTable('gTable', S.gps.sort(byDateAsc), ['date','dur','dist','ts','rpe','srpe']);
    };
    document.getElementById('gView').onclick = ()=>renderTable('gTable', S.gps.sort(byDateAsc), ['date','dur','dist','ts','rpe','srpe']);

    // ----- Gym -----
    document.getElementById('yAdd').onclick = ()=>{
      const r = {
        date: document.getElementById('yDate').value || todayStr(),
        lift: document.getElementById('yLift').value||'',
        reps: num('yReps'), w: num('yW')
      };
      S.gym.push(r); save();
      renderTable('yTable', S.gym.sort(byDateAsc), ['date','lift','reps','w']);
    };
    document.getElementById('yView').onclick = ()=>renderTable('yTable', S.gym.sort(byDateAsc), ['date','lift','reps','w']);

    // ----- Import/Export/Clear -----
    document.getElementById('btnExport').onclick = ()=>{
      const blob = new Blob([JSON.stringify(S,null,2)], {type:'application/json'});
      const a=document.createElement('a'); a.href=URL.createObjectURL(blob);
      a.download='athlete_data_export.json'; a.click(); URL.revokeObjectURL(a.href);
    };
    document.getElementById('btnClear').onclick = ()=>{
      if(confirm('Delete all locally saved data?')){ localStorage.clear(); S.wellness=[]; S.gps=[]; S.gym=[]; drawAll(); }
    };
    document.getElementById('importFile').addEventListener('change', e=>{
      const f=e.target.files[0]; if(!f) return; const r=new FileReader();
      r.onload=()=>{ try{ const j=JSON.parse(r.result); S.wellness=j.wellness||[]; S.gps=j.gps||[]; S.gym=j.gym||[]; save(); }catch(err){ alert('Invalid JSON'); } };
      r.readAsText(f);
    });

    // ----- Helpers -----
    function num(id){ const v = document.getElementById(id).value; const n=Number(v); return Number.isFinite(n)? n : null; }
    const byDateAsc = (a,b)=> (a.date||'').localeCompare(b.date||'');
    function renderTable(elId, rows, cols){
      const el=document.getElementById(elId);
      if(!rows.length){ el.innerHTML='<div class="hint">No data yet.</div>'; return; }
      const head = '<tr>'+cols.map(c=>`<th>${c}</th>`).join('')+'</tr>';
      const body = rows.slice().reverse().map(r=>'<tr>'+cols.map(c=>`<td>${r[c]??''}</td>`).join('')+'</tr>').join('');
      el.innerHTML = `<table>${head}${body}</table>`;
    }

    // ----- Charts + Glance -----
    let weightChart, gpsChart;
    function drawAll(){ drawWeight(); drawGPS(); drawGlance(); }

    function drawWeight(){
      const ctx=document.getElementById('weightChart'); if(!ctx) return;
      const data = S.wellness.slice().sort(byDateAsc).filter(r=>r.weight!=null);
      const labels = data.map(r=>r.date); const vals = data.map(r=>+r.weight);
      if(weightChart) weightChart.destroy();
      weightChart = new Chart(ctx,{type:'line',data:{labels,datasets:[{label:'Weight (kg)',data:vals}]},options:{responsive:true}});
    }
    function drawGPS(){
      const ctx=document.getElementById('gpsChart'); if(!ctx) return;
      const byDay={};
      S.gps.forEach(r=>{ const k=r.date; byDay[k]=byDay[k]||{dist:0,ts:0}; byDay[k].dist+=(+r.dist||0); byDay[k].ts=Math.max(byDay[k].ts,(+r.ts||0)); });
      const labels = Object.keys(byDay).sort();
      const dist = labels.map(d=>byDay[d].dist); const ts = labels.map(d=>byDay[d].ts);
      if(gpsChart) gpsChart.destroy();
      gpsChart = new Chart(ctx,{type:'line',data:{labels,datasets:[{label:'Distance (m)',data:dist},{label:'Top Speed (m/s)',data:ts}]},options:{responsive:true}});
    }
    function drawGlance(){
      const g=document.getElementById('glance'); if(!g) return;
      const y=todayStr();
      const w=S.wellness.find(r=>r.date===y);
      const sessions=S.gps.filter(r=>r.date===y);
      const dist=sessions.reduce((a,b)=>a+(+b.dist||0),0);
      const ts=Math.max(0,...sessions.map(x=>+x.ts||0));
      g.innerHTML=`Date: <b>${y}</b> ‚Äî Sleep: <b>${w?.sleep??'‚Äî'}h</b>, Weight: <b>${w?.weight??'‚Äî'}kg</b>, Dist: <b>${Math.round(dist)}</b> m, Top speed: <b>${ts.toFixed(2)}</b> m/s`;
    }

    // init
    selectTab('home');
  </script>
</body>
</html>
